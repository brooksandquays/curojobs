<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="keywords" content="CuroJobs, Find Jobs, Healthcare Jobs, Social Service Jobs">
    <meta name="description" content="Search and filter job listings on CuroJobs.">
    <meta property="og:site_name" content="CuroJobs">
    <meta property="og:url" content="https://curojobs.com">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Find Jobs | CuroJobs">
    <meta name='og:image' content='images/assets/ogg.png'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Jobs | CuroJobs</title>
    <link rel="icon" type="image/png" sizes="56x56" href="images/fav-icon/icon.png">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" media="all">
    <link rel="stylesheet" type="text/css" href="css/style.css" media="all">
    <link rel="stylesheet" type="text/css" href="css/responsive.css" media="all">
</head>

<body>
    <div class="main-page-wrapper">
        <div id="preloader">
            <div id="ctn-preloader" class="ctn-preloader">
                <div class="animation-preloader">
                    <div class="spinner"></div>
                    <div class="txt-loading">
                        <span data-text-preloader="C" class="letters-loading">C</span>
                        <span data-text-preloader="U" class="letters-loading">U</span>
                        <span data-text-preloader="R" class="letters-loading">R</span>
                        <span data-text-preloader="O" class="letters-loading">O</span>
                        <span data-text-preloader="J" class="letters-loading">J</span>
                        <span data-text-preloader="O" class="letters-loading">O</span>
                        <span data-text-preloader="B" class="letters-loading">B</span>
                        <span data-text-preloader="S" class="letters-loading">S</span>
                    </div>
                </div>
            </div>
        </div>

        <header class="theme-main-menu menu-overlay menu-style-one sticky-menu">
            <div class="inner-content position-relative">
                <div class="top-header">
                    <div class="d-flex align-items-center">
                        <div class="logo order-lg-0">
                            <a href="index.html" class="d-flex align-items-center">
                                <img src="images/logo/logo_01.png" alt="CuroJobs Logo" class="curo">
                            </a>
                        </div>
                        <div class="right-widget ms-auto order-lg-3">
                            <ul id="auth-links" class="d-flex align-items-center style-none">
                                </ul>
                        </div>
                        <nav class="navbar navbar-expand-lg p0 ms-lg-5 ms-3 order-lg-2">
                            <button class="navbar-toggler d-block d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                                <span></span>
                            </button>
                            <div class="collapse navbar-collapse" id="navbarNav">
                                <ul class="navbar-nav align-items-lg-center">
                                    <li class="d-block d-lg-none"><div class="logo"><a href="index.html" class="d-block"><img src="images/logo/logo_01.png" alt="" class="curo"></a></div></li>
                                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                                    <li class="nav-item"><a class="nav-link" href="about-us.html">About Us</a></li>
                                    <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
                                    <li class="d-md-none"><a href="login.html" class="job-post-btn tran3s">Post Job</a></li>
                                    <li class="d-md-none"><a href="login.html" class="btn-one w-100">Hire Top Talents</a></li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </header>


        <div class="inner-banner-one position-relative">
            <div class="container">
                <div class="position-relative">
                    <div class="row">
                        <div class="col-xl-6 m-auto text-center">
                            <div class="title-two">
                                <h2 class="text-white">Job Listings</h2>
                            </div>
                            <p class="text-lg text-white mt-30 lg-mt-20 mb-35 lg-mb-20">Find your next career opportunity with CuroJobs.</p>
                        </div>
                    </div>
                    <!-- Search Form -->
                    <div class="job-search-one position-relative me-xl-5">
                        <form id="job-page-search-form">
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="input-box">
                                        <div class="label">What are you looking for?</div>
                                        <input type="text" placeholder="Job title, keyword, company" class="keyword" id="banner-search-input">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="input-box border-left">
                                        <div class="label">Category</div>
                                        <select class="nice-select lg" id="banner-category-select">
                                            <option value="Hospitals/Clinics">Hospitals/Clinics</option>
                                            <option value="Home Health/Hospice">Home Health/Hospice</option>
                                            <option value="Behavioral/Mental Health Services">Behavioral/Mental Health Services</option>
                                            <option value="Assisted Living/Long-Term Care">Assisted Living/Long-Term Care</option>
                                            <option value="Social Work/Human Services">Social Work/Human Services</option>
                                            <option value="Telehealth/Virtual Care">Telehealth/Virtual Care</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <button class="fw-500 text-uppercase h-100 tran3s search-btn">Search</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <img src="images/shape/shape_02.svg" alt="" class="lazy-img shapes shape_01">
            <img src="images/shape/shape_03.svg" alt="" class="lazy-img shapes shape_02">
        </div>

        <section class="job-listing-three pt-110 lg-pt-80 pb-160 xl-pb-150 lg-pb-80">
            <div class="container">
                <div class="row">
                    <div class="col-xl-3 col-lg-4">
                        <button type="button" class="filter-btn w-100 pt-2 pb-2 h-auto fw-500 tran3s d-lg-none mb-40" data-bs-toggle="offcanvas" data-bs-target="#filteroffcanvas">
                            <i class="bi bi-funnel"></i>
                            Filter
                        </button>
                        <div class="filter-area-tab offcanvas offcanvas-start" id="filteroffcanvas">
                            <button type="button" class="btn-close text-reset d-lg-none" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                            <div class="main-title fw-500 text-dark">Filter By</div>
                            <form id="job-filter-form" class="light-bg border-20 ps-4 pe-4 pt-25 pb-30 mt-20">
                                <div class="filter-block bottom-line pb-25">
                                    <a class="filter-title fw-500 text-dark" data-bs-toggle="collapse" href="#collapseKeyword" role="button" aria-expanded="true">Keywords</a>
                                    <div class="collapse show" id="collapseKeyword">
                                        <div class="main-body">
                                            <input type="text" id="filter-keyword" placeholder="Job title, keywords..." class="w-100 bg-white p-2" style="border: 1px solid #e8e8e8; border-radius: 5px;">
                                        </div>
                                    </div>
                                </div>
                                <div class="filter-block bottom-line pb-25 mt-25">
                                    <a class="filter-title fw-500 text-dark" data-bs-toggle="collapse" href="#collapseLocation" role="button" aria-expanded="true">Location</a>
                                    <div class="collapse show" id="collapseLocation">
                                        <div class="main-body">
                                            <input type="text" id="filter-location" placeholder="City or State" class="w-100 bg-white p-2" style="border: 1px solid #e8e8e8; border-radius: 5px;">
                                        </div>
                                    </div>
                                </div>
                                <div class="filter-block bottom-line pb-25 mt-25">
                                    <a class="filter-title fw-500 text-dark" data-bs-toggle="collapse" href="#collapseJobType" role="button" aria-expanded="true">Job Type</a>
                                    <div class="collapse show" id="collapseJobType">
                                        <ul class="style-none filter-input">
                                            <li><input type="checkbox" name="job_type" value="Full-time"><label>Full-time</label></li>
                                            <li><input type="checkbox" name="job_type" value="Part-time"><label>Part-time</label></li>
                                            <li><input type="checkbox" name="job_type" value="Contract"><label>Contract</label></li>
                                        </ul>
                                    </div>
                                </div>
                                <button type="button" id="reset-filter-btn" class="btn-ten fw-500 text-white w-100 text-center tran3s mt-30">Reset Filters</button>
                            </form>
                        </div>
                    </div>

                    <div class="col-xl-9 col-lg-8">
                        <div class="job-post-item-wrapper ms-xxl-5 ms-xl-3">
                            <div class="upper-filter d-flex justify-content-between align-items-center mb-20">
                                <div class="total-job-found" id="total-job-found">Loading jobs...</div>
                                <div class="d-flex align-items-center">
                                    <div class="short-filter d-flex align-items-center">
                                        <div class="text-dark fw-500 me-2">Sort:</div>
                                        <select class="nice-select" id="sort-by">
                                            <option value="latest">Latest</option>
                                            <option value="oldest">Oldest</option>
                                        </select>
                                    </div>
                                    <button class="style-changer-btn text-center rounded-circle tran3s ms-2 list-btn active" title="List View"><i class="bi bi-list"></i></button>
                                    <button class="style-changer-btn text-center rounded-circle tran3s ms-2 grid-btn" title="Grid View"><i class="bi bi-grid"></i></button>
                                </div>
                            </div>
                            
                            <div id="job-listing-container" class="accordion-box list-style show">
                                </div>
                            <div id="job-grid-container" class="accordion-box grid-style">
                                <div class="row">
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="footer-one" id="contact">
            <div class="container">
                <div class="inner-wrapper">
                    <div class="row">
                        <div class="col-lg-3 col-md-4 footer-intro mb-30">
                            <div class="logo mb-15">
                                <a href="index.html" class="d-flex align-items-center">
                                    <img src="images/logo/logo_01.png" alt="CuroJobs" class="curo">
                                </a>
                            </div> 
                            <p>Your trusted platform for careers in care and service.</p>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-6 mb-30">
                            <h5 class="footer-title">Servicesâ€‹</h5>
                            <ul class="footer-nav-link style-none">
                                <li><a href="job-list-v1.html">Browse Jobs</a></li>
                                <li><a href="#">Companies (soon)</a></li>
                                <li><a href="#">Candidates (soon)</a></li>
                            </ul>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-6 mb-30">
                            <h5 class="footer-title">Company</h5>
                            <ul class="footer-nav-link style-none">
                                <li><a href="about-us.html">About us</a></li>
                                <li><a href="#">Blogs (soon)</a></li>
                                <li><a href="#contact">Contact</a></li>
                            </ul>
                        </div>
                        <div class="col-lg-2 col-md-3 col-sm-4 mb-30">
                            <h5 class="footer-title">Support</h5>
                            <ul class="footer-nav-link style-none">
                                <li><a href="#">Terms of use</a></li>
                                <li><a href="#">Privacy</a></li>
                            </ul>
                        </div>
                        <div class="col-lg-3 mb-30 footer-newsletter">
                            <h5 class="footer-title">Newsletter</h5>
                            <p>Join & get important new regularly</p>
                            <form action="#" class="d-flex">
                                <input type="email" placeholder="Enter your email*">
                                <button type="submit">Send</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bottom-footer">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-lg-4 order-lg-3 mb-15">
                            <ul class="style-none d-flex order-lg-last justify-content-center justify-content-lg-end social-icon">
                                <li><a href="#"><i class="bi-linkedin"></i></a></li>
                                <li><a href="#"><i class="bi-twitter"></i></a></li>
                                <li><a href="#"><i class="bi-facebook"></i></a></li>
                            </ul>
                        </div>
                        <div class="col-lg-4 order-lg-1 mb-15">
                            <p class="text-center text-lg-start mb-15">Copyright @2025 CuroJobs Inc.</p>
                        </div>
                        <div class="col-lg-4 order-lg-2">
                            <ul class="d-flex style-none bottom-nav justify-content-center justify-content-lg-end">
                                <li><a href="#">Privacy & Terms.</a></li>
                                <li><a href="#contact"> Contact Us</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

		<button class="scroll-top"><i class="bi bi-arrow-up-short"></i></button>

		<script src="vendor/jquery.min.js"></script>
		<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
		<script src="vendor/wow/wow.min.js"></script>
		<script src="vendor/jquery.lazy.min.js"></script>
		<script src="vendor/nice-select/jquery.nice-select.min.js"></script>
		<script src="vendor/jwt-decode.js"></script>
		<script src="js/theme.js"></script>

		<script>
			document.addEventListener('DOMContentLoaded', () => {
				const authLinksContainer = document.getElementById('auth-links');
				const jobListContainer = document.getElementById('job-listing-container');
                const jobGridContainer = document.getElementById('job-grid-container').querySelector('.row');
				const totalJobFoundEl = document.getElementById('total-job-found');
				const filterForm = document.getElementById('job-filter-form');
				const resetBtn = document.getElementById('reset-filter-btn');
				const sortBySelect = document.getElementById('sort-by');
				
				const BASE_API_URL = 'http://127.0.0.1:8000/api/v1/jobs/';
                let allJobs = []; // Cache for all jobs

				const setupAuthLinks = () => {
					const accessToken = localStorage.getItem('accessToken');
					if (accessToken) {
						try {
							const decoded = jwt_decode(accessToken);
							const dashboardUrl = decoded.user_type === 'applicant' ? 'dashboard/applicant/candidate-dashboard-index.html' : 'dashboard/employer/employer-dashboard-index.html';
							authLinksContainer.innerHTML = `
								<li><a href="${dashboardUrl}" class="login-btn-one">Dashboard</a></li>
								<li class="d-none d-md-block ms-4"><a href="#" id="logout-btn" class="btn-one">Logout</a></li>`;
							document.getElementById('logout-btn').addEventListener('click', e => {
								e.preventDefault();
								localStorage.clear();
								window.location.reload();
							});
						} catch (e) {
							localStorage.clear();
							setupAuthLinks();
						}
					} else {
						authLinksContainer.innerHTML = `
							<li><a href="login.html" class="login-btn-one">Login</a></li>
							<li class="d-none d-md-block ms-4"><a href="signup.html" class="btn-one">Sign Up</a></li>`;
					}
				};

				const renderJobs = (jobs) => {
					totalJobFoundEl.innerHTML = `All <span class="text-dark">${jobs.length}</span> jobs found`;
					if (jobs.length === 0) {
						jobListContainer.innerHTML = '<div class="text-center p-5"><h4>No jobs found matching your criteria.</h4></div>';
						jobGridContainer.innerHTML = '';
						return;
					}
					jobListContainer.innerHTML = jobs.map(getJobListHtml).join('');
					jobGridContainer.innerHTML = jobs.map(getJobGridHtml).join('');
				};

				const getJobListHtml = (job) => {
					const companyInitial = job.company_name ? job.company_name.charAt(0).toUpperCase() : '?';
					return `
						<div class="job-list-one style-two position-relative border-style mb-20">
							<div class="row justify-content-between align-items-center">
								<div class="col-md-5">
									<div class="job-title d-flex align-items-center">
										<a href="job-details.html?id=${job.id}" class="logo"><div class="logo-initial">${companyInitial}</div></a>
										<div class="split-box1 ms-3">
											<div class="job-duration fw-500">${job.job_type || 'N/A'}</div>
											<a href="job-details.html?id=${job.id}" class="title fw-500 tran3s">${job.title}</a>
										</div>
									</div>
								</div>
								<div class="col-md-4 col-sm-6">
									<div class="job-location"><i class="bi bi-geo-alt"></i> ${job.location || 'N/A'}</div>
									<div class="job-salary"><span class="fw-500 text-dark">${job.salary || 'Competitive'}</span></div>
								</div>
								<div class="col-md-3 col-sm-6">
									<div class="btn-group d-flex align-items-center justify-content-sm-end xs-mt-20">
										<a href="job-details.html?id=${job.id}" class="apply-btn text-center tran3s">APPLY</a>
									</div>
								</div>
							</div>
						</div>`;
				};

				const getJobGridHtml = (job) => {
					const companyInitial = job.company_name ? job.company_name.charAt(0).toUpperCase() : '?';
					return `
						<div class="col-sm-6 mb-30">
							<div class="job-list-two style-two position-relative">
								<a href="job-details.html?id=${job.id}" class="logo"><div class="logo-initial">${companyInitial}</div></a>
								<div class="job-duration fw-500">${job.job_type || 'N/A'}</div>
								<a href="job-details.html?id=${job.id}" class="title fw-500 tran3s">${job.title}</a>
								<div class="job-salary"><span class="fw-500 text-dark">${job.salary || 'Competitive'}</span></div>
								<div class="d-flex align-items-center justify-content-between mt-auto">
									<div class="job-location"><a href="#"><i class="bi bi-geo-alt"></i> ${job.location || 'N/A'}</a></div>
									<a href="job-details.html?id=${job.id}" class="apply-btn text-center tran3s">APPLY</a>
								</div>
							</div>
						</div>`;
				};

				const filterAndSortJobs = () => {
					const keyword = document.getElementById('filter-keyword').value.toLowerCase();
					const location = document.getElementById('filter-location').value.toLowerCase();
					const checkedJobTypes = Array.from(document.querySelectorAll('input[name="job_type"]:checked')).map(cb => cb.value);
					const sortBy = sortBySelect.value;

					let jobsToDisplay = allJobs.filter(job => {
						const keywordMatch = !keyword || (job.title && job.title.toLowerCase().includes(keyword));
						const locationMatch = !location || (job.location && job.location.toLowerCase().includes(location));
						const jobTypeMatch = checkedJobTypes.length === 0 || (job.job_type && checkedJobTypes.includes(job.job_type));
						return keywordMatch && locationMatch && jobTypeMatch;
					});
					
					jobsToDisplay.sort((a, b) => {
						if (sortBy === 'oldest') return new Date(a.created_at) - new Date(b.created_at);
						return new Date(b.created_at) - new Date(a.created_at);
					});

					renderJobs(jobsToDisplay);
				};

				const init = async () => {
					setupAuthLinks();

                    // --- NEW: Handle banner search form ---
                    const bannerSearchForm = document.getElementById('job-page-search-form');
                    if (bannerSearchForm) {
                        bannerSearchForm.addEventListener('submit', (e) => {
                            e.preventDefault();
                            const bannerKeyword = document.getElementById('banner-search-input').value;
                            document.getElementById('filter-keyword').value = bannerKeyword;
                            filterAndSortJobs();
                        });
                    }
					
					try {
						const response = await fetch(BASE_API_URL);
						if (!response.ok) throw new Error('Network response was not ok');
						allJobs = await response.json();
						
						const urlParams = new URLSearchParams(window.location.search);
						const initialKeyword = urlParams.get('title') || urlParams.get('search');
						if (initialKeyword) {
							document.getElementById('filter-keyword').value = initialKeyword;
						}

						filterAndSortJobs();
					} catch (error) {
						console.error("Could not fetch jobs:", error);
						totalJobFoundEl.textContent = "Could not load jobs.";
						jobListContainer.innerHTML = `<div class="text-center p-5 text-danger"><h4>Error loading jobs from the server.</h4></div>`;
					}

					filterForm.addEventListener('input', filterAndSortJobs);
					$(sortBySelect).on('change', filterAndSortJobs);
					resetBtn.addEventListener('click', () => {
						filterForm.reset();
						filterAndSortJobs();
					});
				};

				init();
			});
		</script>
		
		<style>
			.logo-initial {
				width: 50px; height: 50px;
				border-radius: 8px; background-color: #f0f5ff;
				display: flex; align-items: center; justify-content: center;
				font-size: 24px; font-weight: 500; color: #4866a6;
			}
			.job-list-two .logo-initial { width: 60px; height: 60px; }
		</style>
	</div>
</body>
</html>